(function(){Array.prototype.shuffle=function(){var c,b,a,d;for(c=d=this.length;d<=1?c<=1:c>=1;d<=1?c++:c--){b=parseInt(Math.random()*c);a=this[--c];this[c]=this[b];this[b]=a}return this};(function(a){var b;b=function(d,e){var h,w,q,t,f,n,s,o,u,l,v,c,g,x,p,k,r,m,y,j;x=a.extend({},a.fn.ramblingSlider.defaults,e);m={currentSlide:0,currentImage:"",totalSlides:0,randAnim:"",running:false,paused:false,stop:false};n={};f={setSliderBackground:function(i,z){return i.css({background:"url("+(z.currentImage.attr("src"))+") no-repeat"})},getRamblingSlice:function(D,i,B,C){var z,E,A;z="url("+(C.currentImage.attr("src"))+") no-repeat -"+((D+(i*D))-D)+"px 0%";A=D;if(i===(B-1)){z="url("+(C.currentImage.attr("src"))+") no-repeat -"+((D+(i*D))-D)+"px 0%";A=p.width()-(D*i)}E={left:(D*i)+"px",width:A+"px",height:"0px",opacity:"0",background:z,overflow:"hidden"};return a('<div class="rambling-slice"></div>').css(E)},getRamblingBox:function(C,E,G,A,B,D){var i,F,z;i="url("+(D.currentImage.attr("src"))+") no-repeat -"+((C+(A*C))-C)+"px -"+((E+(G*E))-E)+"px";z=C;if(A===(B.boxCols-1)){i="url("+(D.currentImage.attr("src"))+") no-repeat -"+((C+(A*C))-C)+"px -"+((E+(G*E))-E)+"px";z=p.width()-(C*A)}F={opacity:0,left:(C*A)+"px",top:(E*G)+"px",width:z+"px",height:E+"px",background:i,overflow:"hidden"};return a('<div class="rambling-box"></div>').css(F)}};h={setSliderBackground:function(){var A,i,z;z=m.currentImage;i=p.find(".currentImage");if(!i.length){A="alignTop";if(x.alignBottom){A="alignBottom"}i=a('<img src="" alt="currentImage" class="currentImage"/>');i.addClass(A);i.css({display:"block"});p.find("#rambling-animation").prepend(i)}return i.attr({src:z.attr("src"),alt:z.attr("alt")})},getRamblingSlice:function(F,i,C,E){var A,B,z,D;B=f.getRamblingSlice(F,i,C,E);B.css({background:"none"});B.append('<span><img src="'+(E.currentImage.attr("src"))+'" alt=""/></span>');A=0;D="auto";if(x.alignBottom){A="auto";D=0}z={display:"block",width:p.width(),left:"-"+((F+(i*F))-F)+"px",bottom:A,top:D};B.find("img").css(z);return B},getRamblingBox:function(D,F,H,A,B,E){var i,C,z,G;C=f.getRamblingBox(D,F,H,A,B,E);i=false;G=""+((F+(H*F))-F)+"px";if(B.alignBottom){i=""+(F*(B.boxRows-(H+1)))+"px";G=false}z={display:"block",width:p.width(),left:"-"+((D+(A*D))-D)+"px",top:"auto",bottom:"auto"};if(G){z.top="-"+G}if(i){z.bottom="-"+i}C.css({background:"none",top:G||"auto",bottom:i||"auto"});C.append('<span><img src="'+E.currentImage.attr("src")+'" alt=""/></span>');C.find("img").css(z);return C}};a.extend(n,f);if(x.adaptImages){a.extend(n,h)}p=a(d);p.data("rambling:vars",m);p.css({position:"relative"});p.addClass("ramblingSlider");if(x.adaptImages){v=a('<div id="rambling-animation"></div>');v.css({width:p.width(),height:p.height(),overflow:"hidden"});p.prepend(v);p.addClass("adaptingSlider")}o=p.children(":not(#rambling-animation)");o.each(function(){var B,i,z,A;B=a(this);A="";if(!B.is("img")){if(B.is("a")){B.addClass("rambling-imageLink");A=B}B=B.find("img:first")}z=B.width();if(z===0){z=B.attr("width")}i=B.height();if(i===0){i=B.attr("height")}if(z>p.width()&&x.useLargerImage){p.width(z)}if(i>p.height()&&(x.useLargerImage||!x.adaptImages)){p.height(i)}if(A!==""){A.css({display:"none"})}B.css({display:"none"});return m.totalSlides++});if(x.startSlide>0){if(x.startSlide>=m.totalSlides){x.startSlide=m.totalSlides-1}m.currentSlide=x.startSlide}if(a(o[m.currentSlide]).is("img")){m.currentImage=a(o[m.currentSlide])}else{m.currentImage=a(o[m.currentSlide]).find("img:first")}if(a(o[m.currentSlide]).is("a")){a(o[m.currentSlide]).css("display","block")}n.setSliderBackground(p,m);p.append(a('<div class="rambling-caption"><p></p></div>').css({display:"none",opacity:x.captionOpacity}));l=function(z){var i,A;i=a(".rambling-caption",p);A=m.currentImage.attr("title");if((A!=null)&&A!==""){if(A.substr(0,1)==="#"){A=a(A).html()}if(i.css("display")==="block"){i.find("p").fadeOut(z.animSpeed,function(){a(this).html(A);return a(this).fadeIn(z.animSpeed)})}else{i.find("p").html(A)}return i.fadeIn(z.animSpeed)}else{return i.fadeOut(z.animSpeed)}};l(x);k=0;if(!x.manualAdvance&&o.length>1){k=setInterval((function(){return g(p,o,x,false)}),x.pauseTime)}w=function(){clearInterval(k);return k=""};if(x.directionNav){p.append('<div class="rambling-directionNav"><a class="rambling-prevNav">'+x.prevText+'</a><a class="rambling-nextNav">'+x.nextText+"</a></div>");if(x.directionNavHide){a(".rambling-directionNav",p).hide();p.hover((function(){return a(".rambling-directionNav",p).show()}),(function(){return a(".rambling-directionNav",p).hide()}))}u=function(A,i,z,B){if(m.running){return false}w();m.currentSlide-=2;return g(A,i,z,B)};a("a.rambling-prevNav",p).live("click",function(){return u("prev")});a("a.rambling-nextNav",p).live("click",function(){return u("next")})}if(x.controlNav){c=a('<div class="rambling-controlNav"></div>');p.append(c);y=function(z){var A;if(x.controlNavThumbs){A=o.eq(z);if(!A.is("img")){A=A.find("img:first")}if(x.controlNavThumbsFromRel){return c.append('<a class="rambling-control" rel="'+z+'"><img src="'+A.attr("rel")+'" alt="" /></a>')}else{return c.append('<a class="rambling-control" rel="'+z+'"><img src="'+A.attr("src").replace(x.controlNavThumbsSearch,x.controlNavThumbsReplace)+'" alt="" /></a>')}}else{return c.append('<a class="rambling-control" rel="'+z+'">'+(z+1)+"</a>")}};for(s=0,j=o.length-1;0<=j?s<=j:s>=j;0<=j?s++:s--){y(s)}a(".rambling-controlNav a:eq("+m.currentSlide+")",p).addClass("active");a(".rambling-controlNav a",p).live("click",function(){if(m.running){return false}if(a(this).hasClass("active")){return false}w();n.setSliderBackground(p,m);m.currentSlide=a(this).attr("rel")-1;return g(p,o,x,"control")})}if(x.keyboardNav){a(window).keypress(function(i){if(i.keyCode==="37"){if(m.running){return false}w();m.currentSlide-=2;g(p,o,x,"prev")}if(i.keyCode==="39"){if(m.running){return false}w();return g(p,o,x,"next")}})}if(x.pauseOnHover){p.hover(function(){m.paused=true;return w()},function(){m.paused=false;if(k===""&&!x.manualAdvance){return k=setInterval((function(){return g(p,o,x,false)}),x.pauseTime)}})}p.bind("rambling:animFinished",function(){m.running=false;a(o).each(function(){if(a(this).is("a")){return a(this).css({display:"none"})}});if(a(o[m.currentSlide]).is("a")){a(o[m.currentSlide]).css({display:"block"})}if(k===""&&!m.paused&&!x.manualAdvance){k=setInterval((function(){return g(p,o,x,false)}),x.pauseTime)}n.setSliderBackground(p,m);return x.afterChange.call(this)});t=function(C,B,D){var A,E,z;z=[];for(A=0,E=B.slices-1;0<=E?A<=E:A>=E;0<=E?A++:A--){z.push((function(G){var F,H;H=Math.round(C.width()/B.slices);F=C;if(B.adaptImages){F=C.find("#rambling-animation")}return F.append(n.getRamblingSlice(H,G,B.slices,D))})(A))}return z};q=function(B,z,D){var E,A,C,F,i;A=Math.round(B.width()/z.boxCols);E=Math.round(B.height()/z.boxRows);i=[];for(C=0,F=z.boxRows-1;0<=F?C<=F:C>=F;0<=F?C++:C--){i.push((function(H){var I,J,G;G=[];for(I=0,J=z.boxCols-1;0<=J?I<=J:I>=J;0<=J?I++:I--){G.push((function(L){var K;K=B;if(z.adaptImages){K=B.find("#rambling-animation")}return K.append(n.getRamblingBox(A,E,H,L,z,D))})(I))}return G})(C))}return i};g=function(L,K,N,I){var P,H,B,J,F,E,D,C,z,O,M,G,A,i;m=L.data("rambling:vars");if(m&&m.currentSlide===m.totalSlides-1){N.lastSlide.call(this)}if((!m||m.stop)&&!I){return false}N.beforeChange.call(this);m.currentSlide++;if(m.currentSlide===m.totalSlides){m.currentSlide=0;N.slideshowEnd.call(this)}if(m.currentSlide<0){m.currentSlide=m.totalSlides-1}if(a(K[m.currentSlide]).is("img")){m.currentImage=a(K[m.currentSlide])}else{m.currentImage=a(K[m.currentSlide]).find("img:first")}if(N.controlNav){a(".rambling-controlNav a",L).removeClass("active");a(".rambling-controlNav a:eq("+m.currentSlide+")",L).addClass("active")}l(N);a(".rambling-slice",L).remove();a(".rambling-box",L).remove();if(N.effect==="random"){P=["sliceDownRight","sliceDownLeft","sliceUpRight","sliceUpLeft","sliceUpDown","sliceUpDownLeft","fold","fade","boxRandom","boxRain","boxRainReverse","boxRainGrow","boxRainGrowReverse"];m.randAnim=P[Math.floor(Math.random()*(P.length+1))];if(!m.randAnim){m.randAnim="fade"}}if(N.effect.indexOf(",")!==-1){P=N.effect.split(",");m.randAnim=P[Math.floor(Math.random()*P.length)];if(m.randAnim){m.randAnim="fade"}}m.running=true;if(N.effect==="sliceDown"||N.effect==="sliceDownRight"||m.randAnim==="sliceDownRight"||N.effect==="sliceDownLeft"||m.randAnim==="sliceDownLeft"){t(L,N,m);O=0;s=0;z=a(".rambling-slice",L);if(N.effect==="sliceDownLeft"||m.randAnim==="sliceDownLeft"){z=a(".rambling-slice",L).reverse()}return z.each(function(){var Q;Q=a(this);Q.css({top:"0px"});if(s===N.slices-1){setTimeout(function(){return Q.animate({height:"100%",opacity:"1.0"},N.animSpeed,"",function(){return L.trigger("rambling:animFinished")})},100+O)}else{setTimeout((function(){return Q.animate({height:"100%",opacity:"1.0"},N.animSpeed)}),100+O)}O+=50;return s++})}else{if(N.effect==="sliceUp"||N.effect==="sliceUpRight"||m.randAnim==="sliceUpRight"||N.effect==="sliceUpLeft"||m.randAnim==="sliceUpLeft"){t(L,N,m);O=0;s=0;z=a(".rambling-slice",L);if(N.effect==="sliceUpLeft"||m.randAnim==="sliceUpLeft"){z=a(".rambling-slice",L).reverse()}return z.each(function(){var Q;Q=a(this);Q.css({bottom:"0px"});if(s===N.slices-1){setTimeout((function(){return Q.animate({height:"100%",opacity:"1.0"},N.animSpeed,"",function(){return L.trigger("rambling:animFinished")})}),100+O)}else{setTimeout((function(){return Q.animate({height:"100%",opacity:"1.0"},N.animSpeed)}),100+O)}O+=50;return s++})}else{if(N.effect==="sliceUpDown"||N.effect==="sliceUpDownRight"||m.randAnim==="sliceUpDown"||N.effect==="sliceUpDownLeft"||m.randAnim==="sliceUpDownLeft"){t(L,N,m);O=0;s=0;G=0;z=a(".rambling-slice",L);if(N.effect==="sliceUpDownLeft"||m.randAnim==="sliceUpDownLeft"){z=a(".rambling-slice",L).reverse()}return z.each(function(){var Q;Q=a(this);if(s===0){Q.css("top","0px");s++}else{Q.css("bottom","0px");s=0}if(G===N.slices-1){setTimeout((function(){return Q.animate({height:"100%",opacity:"1.0"},N.animSpeed,"",function(){return L.trigger("rambling:animFinished")})}),100+O)}else{setTimeout((function(){return Q.animate({height:"100%",opacity:"1.0"},N.animSpeed)}),100+O)}O+=50;return G++})}else{if(N.effect==="fold"||m.randAnim==="fold"){t(L,N,m);O=0;s=0;return a(".rambling-slice",L).each(function(){var R,Q;Q=a(this);R=Q.width();Q.css({top:"0px",height:"100%",width:"0px"});if(s===N.slices-1){setTimeout((function(){return Q.animate({width:R,opacity:"1.0"},N.animSpeed,"",function(){return L.trigger("rambling:animFinished")})}),100+O)}else{setTimeout((function(){return Q.animate({width:R,opacity:"1.0"},N.animSpeed)}),100+O)}O+=50;return s++})}else{if(N.effect==="fade"||m.randAnim==="fade"){t(L,N,m);E=a(".rambling-slice:first",L);C={height:"100%",width:L.width()+"px",position:"absolute",top:0,left:0};E.css(C);return E.animate({opacity:"1.0"},N.animSpeed*2,"",function(){return L.trigger("rambling:animFinished")})}else{if(N.effect==="slideInRight"||m.randAnim==="slideInRight"){t(L,N,m);E=a(".rambling-slice:first",L);C={height:"100%",width:"0px",opacity:"1"};E.css(C);return E.animate({width:L.width()+"px"},N.animSpeed*2,"",function(){return L.trigger("rambling:animFinished")})}else{if(N.effect==="slideInLeft"||m.randAnim==="slideInLeft"){t(L,N,m);E=a(".rambling-slice:first",L);C={height:"100%",width:"0px",opacity:"1",left:"",right:"0px"};E.css(C);return E.animate({width:L.width()+"px"},N.animSpeed*2,"",function(){var Q;Q={left:"0px",right:""};E.css(Q);return L.trigger("rambling:animFinished")})}else{if(N.effect==="boxRandom"||m.randAnim==="boxRandom"){q(L,N,m);M=N.boxCols*N.boxRows;s=0;O=0;B=a(".rambling-box",L).shuffle();return B.each(function(){var Q;Q=a(this);if(s===M-1){setTimeout((function(){return Q.animate({opacity:"1"},N.animSpeed,"",function(){return L.trigger("rambling:animFinished")})}),100+O)}else{setTimeout((function(){return Q.animate({opacity:"1"},N.animSpeed)}),100+O)}O+=20;return s++})}else{if(N.effect==="boxRain"||m.randAnim==="boxRain"||N.effect==="boxRainReverse"||m.randAnim==="boxRainReverse"||N.effect==="boxRainGrow"||m.randAnim==="boxRainGrow"||N.effect==="boxRainGrowReverse"||m.randAnim==="boxRainGrowReverse"){q(L,N,m);M=N.boxCols*N.boxRows;s=0;O=0;D=0;J=0;H=new Array();H[D]=new Array();B=a(".rambling-box",L);if(N.effect==="boxRainReverse"||m.randAnim==="boxRainReverse"||N.effect==="boxRainGrowReverse"||m.randAnim==="boxRainGrowReverse"){B=a(".rambling-box",L).reverse()}B.each(function(){H[D][J]=a(this);J++;if(J===N.boxCols){D++;J=0;return H[D]=new Array()}});i=[];for(F=0,A=N.boxCols*2-1;0<=A?F<=A:F>=A;0<=A?F++:F--){i.push((function(T){var R,S,Q,U;R=T;Q=function(V){if(R>=0&&R<N.boxCols){(function(ac,X,ab,Y,ad){var aa,Z,W;aa=a(H[ac][X]);W=aa.width();Z=aa.height();if(N.effect==="boxRainGrow"||m.randAnim==="boxRainGrow"||N.effect==="boxRainGrowReverse"||m.randAnim==="boxRainGrowReverse"){aa.width(0).height(0)}if(Y===ad-1){return setTimeout((function(){return aa.animate({opacity:"1",width:W,height:Z},N.animSpeed/1.3,"",function(){return L.trigger("rambling:animFinished")})}),100+ab)}else{return setTimeout((function(){return aa.animate({opacity:"1",width:W,height:Z},N.animSpeed/1.3)}),100+ab)}})(V,R,O,s,M);s++}return R--};for(S=0,U=N.boxRows-1;0<=U?S<=U:S>=U;0<=U?S++:S--){Q(S)}return O+=100})(F))}return i}}}}}}}}}};r=function(i){if(this.console&&console&&console.log){return console.log(i)}};this.stop=function(){var i;i=a(d);if(!i.data("rambling:vars").stop){i.data("rambling:vars").stop=true;return r("Stop Slider")}};this.start=function(){var i;i=a(d);if(i.data("rambling:vars").stop){i.data("rambling:vars").stop=false;return r("Start Slider")}};x.afterLoad.call(this);return this};a.fn.ramblingSlider=function(c){return this.each(function(e,g){var d,f;d=a(this);if(d.data("ramblingslider")){return d.data("ramblingslider")}f=new b(this,c);return d.data("ramblingslider",f)})};a.fn.ramblingSlider.defaults={effect:"random",slices:15,boxCols:8,boxRows:4,animSpeed:500,pauseTime:3000,startSlide:0,directionNav:true,directionNavHide:true,controlNav:true,controlNavThumbs:false,controlNavThumbsFromRel:false,controlNavThumbsSearch:".jpg",controlNavThumbsReplace:"_thumb.jpg",adaptImages:false,useLargerImage:true,alignBottom:false,keyboardNav:true,pauseOnHover:true,manualAdvance:false,captionOpacity:0.8,prevText:"Prev",nextText:"Next",beforeChange:function(){},afterChange:function(){},slideshowEnd:function(){},lastSlide:function(){},afterLoad:function(){}};a.fn.reverse=[].reverse;return a.fn.shuffle=[].shuffle})(jQuery)}).call(this);