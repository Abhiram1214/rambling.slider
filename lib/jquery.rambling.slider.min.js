(function(){Array.prototype.shuffle=function(){var c,b,d,a;d=this.length;for(c=d;d<=1?c<=1:c>=1;d<=1?c++:c--){this[c]=this[c];b=parseInt(Math.random()*c);a=this[--c];this[c]=this[b];this[b]=a}return this};Array.prototype.contains=function(c){var a,b;b=this.length;for(a=0;0<=b?a<b:a>b;0<=b?a++:a--){if(c===this[a]){return true}}return false};(function(b){var c,a;c=function(e,f){var k,A,g,t,w,h,m,q,v,r,x,o,z,d,j,y,s,n,u,p,B,l;y=b.extend({},b.fn.ramblingSlider.defaults,f);p={currentSlide:0,currentImage:"",totalSlides:0,randAnim:"",running:false,paused:false,stop:false};q={};h={setSliderBackground:function(i,C){return i.css({background:"url("+(C.currentImage.attr("src"))+") no-repeat"})},getRamblingSlice:function(G,i,E,F){var C,H,D;C="url("+(F.currentImage.attr("src"))+") no-repeat -"+((G+(i*G))-G)+"px 0%";D=G;if(i===(E-1)){C="url("+(F.currentImage.attr("src"))+") no-repeat -"+((G+(i*G))-G)+"px 0%";D=s.width()-(G*i)}H={left:""+(G*i)+"px",width:""+D+"px",height:"0px",opacity:"0",background:C,overflow:"hidden"};return b('<div class="rambling-slice"></div>').css(H)},getRamblingBox:function(F,H,J,D,E,G){var i,I,C;i="url("+(G.currentImage.attr("src"))+") no-repeat -"+((F+(D*F))-F)+"px -"+((H+(J*H))-H)+"px";C=F;if(D===(E.boxCols-1)){i="url("+(G.currentImage.attr("src"))+") no-repeat -"+((F+(D*F))-F)+"px -"+((H+(J*H))-H)+"px";C=s.width()-(F*D)}I={opacity:0,left:""+(F*D)+"px",top:""+(H*J)+"px",width:""+C+"px",height:""+H+"px",background:i,overflow:"hidden"};return b('<div class="rambling-box"></div>').css(I)}};k={setSliderBackground:function(){var D,i,C;C=p.currentImage;i=s.find(".currentImage");if(!i.length){D="alignTop";if(y.alignBottom){D="alignBottom"}i=b('<img src="" alt="currentImage" class="currentImage"/>');i.addClass(D);i.css({display:"block"});s.find("#rambling-animation").prepend(i)}return i.attr({src:C.attr("src"),alt:C.attr("alt")})},getRamblingSlice:function(I,i,F,H){var D,E,C,G;E=h.getRamblingSlice(I,i,F,H);E.css({background:"none"});E.append('<span><img src="'+(H.currentImage.attr("src"))+'" alt=""/></span>');D=0;G="auto";if(y.alignBottom){D="auto";G=0}C={display:"block",width:s.width(),left:"-"+((I+(i*I))-I)+"px",bottom:D,top:G};E.find("img").css(C);return E},getRamblingBox:function(G,I,K,D,E,H){var i,F,C,J;F=h.getRamblingBox(G,I,K,D,E,H);i=false;J=""+((I+(K*I))-I)+"px";if(E.alignBottom){i=""+(I*(E.boxRows-(K+1)))+"px";J=false}C={display:"block",width:s.width(),left:"-"+((G+(D*G))-G)+"px",top:"auto",bottom:"auto"};if(J){C.top="-"+J}if(i){C.bottom="-"+i}F.css({background:"none",top:J||"auto",bottom:i||"auto"});F.append("<span><img src='"+(H.currentImage.attr("src"))+"' alt=''/></span>");F.find("img").css(C);return F}};b.extend(q,h);if(y.adaptImages){b.extend(q,k)}s=b(e);s.data("rambling:vars",p);s.css({position:"relative"});s.addClass("ramblingSlider");if(y.adaptImages){z=b('<div id="rambling-animation"></div>');z.css({width:s.width(),height:s.height(),overflow:"hidden"});s.prepend(z);s.addClass("adaptingSlider")}r=s.children(":not(#rambling-animation)");r.each(function(){var E,i,C,D;E=b(this);D="";if(!E.is("img")){if(E.is("a")){E.addClass("rambling-imageLink");D=E}E=E.find("img:first")}C=E.width();if(C===0){C=E.attr("width")}i=E.height();if(i===0){i=E.attr("height")}if(C>s.width()&&y.useLargerImage){s.width(C)}if(i>s.height()&&(y.useLargerImage||!y.adaptImages)){s.height(i)}if(D!==""){D.css({display:"none"})}E.css({display:"none"});return p.totalSlides++});if(y.startSlide>0){if(y.startSlide>=p.totalSlides){y.startSlide=p.totalSlides-1}p.currentSlide=y.startSlide}if(b(r[p.currentSlide]).is("img")){p.currentImage=b(r[p.currentSlide])}else{p.currentImage=b(r[p.currentSlide]).find("img:first")}if(b(r[p.currentSlide]).is("a")){b(r[p.currentSlide]).css("display","block")}q.setSliderBackground(s,p);s.append(b('<div class="rambling-caption"><p></p></div>').css({display:"none",opacity:y.captionOpacity}));o=function(C){var i,D;i=s.find(".rambling-caption");D=p.currentImage.attr("title");if((D!=null)&&D!==""){if(D.substr(0,1)==="#"){D=b(D).html()}if(i.css("display")==="block"){i.find("p").fadeOut(C.animSpeed,function(){b(this).html(D);return b(this).fadeIn(C.animSpeed)})}else{i.find("p").html(D)}return i.fadeIn(C.animSpeed)}else{return i.fadeOut(C.animSpeed)}};o(y);n=0;if(!y.manualAdvance&&r.length>1){n=setInterval((function(){return j(s,r,y,false)}),y.pauseTime)}A=function(){clearInterval(n);return n=""};if(y.directionNav){s.append("<div class='rambling-directionNav'><a class='rambling-prevNav'>"+y.prevText+"</a><a class='rambling-nextNav'>"+y.nextText+"</a></div>");if(y.directionNavHide){m=s.find(".rambling-directionNav");m.hide();s.hover((function(){return m.show()}),(function(){return m.hide()}))}x=function(D,i,C,E){if(p.running){return false}A();p.currentSlide-=2;return j(D,i,C,E)};s.find("a.rambling-prevNav").live("click",function(){return x("prev")});s.find("a.rambling-nextNav").live("click",function(){return x("next")})}if(y.controlNav){d=b('<div class="rambling-controlNav"></div>');s.append(d);B=function(C){var D;if(y.controlNavThumbs){D=r.eq(C);if(!D.is("img")){D=D.find("img:first")}if(y.controlNavThumbsFromRel){return d.append("<a class='rambling-control' rel='"+C+"'><img src='"+(D.attr("rel"))+"' alt='' /></a>")}else{return d.append("<a class='rambling-control' rel='"+C+"'><img src='"+(D.attr("src").replace(y.controlNavThumbsSearch,y.controlNavThumbsReplace))+"' alt='' /></a>")}}else{return d.append("<a class='rambling-control' rel='"+C+"'>"+(C+1)+"'</a>")}};for(v=0,l=r.length;0<=l?v<l:v>l;0<=l?v++:v--){B(v)}g=s.find(".rambling-controlNav a");g.filter(":eq("+p.currentSlide+")").addClass("active");g.live("click",function(){if(p.running){return false}if(b(this).hasClass("active")){return false}A();q.setSliderBackground(s,p);p.currentSlide=b(this).attr("rel")-1;return j(s,r,y,"control")})}if(y.keyboardNav){b(window).keypress(function(i){if(i.keyCode==="37"){if(p.running){return false}A();p.currentSlide-=2;j(s,r,y,"prev")}if(i.keyCode==="39"){if(p.running){return false}A();return j(s,r,y,"next")}})}if(y.pauseOnHover){s.hover(function(){p.paused=true;return A()},function(){p.paused=false;if(n===""&&!y.manualAdvance){return n=setInterval((function(){return j(s,r,y,false)}),y.pauseTime)}})}s.bind("rambling:animFinished",function(){p.running=false;b(r).each(function(){if(b(this).is("a")){return b(this).css({display:"none"})}});if(b(r[p.currentSlide]).is("a")){b(r[p.currentSlide]).css({display:"block"})}if(n===""&&!p.paused&&!y.manualAdvance){n=setInterval((function(){return j(s,r,y,false)}),y.pauseTime)}q.setSliderBackground(s,p);return y.afterChange.call(this)});w=function(F,E,G){var D,H,C;C=[];for(D=0,H=E.slices;0<=H?D<H:D>H;0<=H?D++:D--){C.push((function(J){var I,K;K=Math.round(F.width()/E.slices);I=F;if(E.adaptImages){I=F.find("#rambling-animation")}return I.append(q.getRamblingSlice(K,J,E.slices,G))})(D))}return C};t=function(E,C,G){var H,D,F,I,i;D=Math.round(E.width()/C.boxCols);H=Math.round(E.height()/C.boxRows);i=[];for(F=0,I=C.boxRows;0<=I?F<I:F>I;0<=I?F++:F--){i.push((function(K){var L,M,J;J=[];for(L=0,M=C.boxCols;0<=M?L<M:L>M;0<=M?L++:L--){J.push((function(O){var N;N=E;if(C.adaptImages){N=E.find("#rambling-animation")}return N.append(q.getRamblingBox(D,H,K,O,C,G))})(L))}return J})(F))}return i};j=function(K,J,O,I){var C,N,E,G,S,D,T,P,R,L,F,i,Q,M,H;p=K.data("rambling:vars");if(p&&p.currentSlide===p.totalSlides-1){O.lastSlide.call(this)}if((!p||p.stop)&&!I){return false}O.beforeChange.call(this);p.currentSlide++;if(p.currentSlide===p.totalSlides){p.currentSlide=0;O.slideshowEnd.call(this)}if(p.currentSlide<0){p.currentSlide=p.totalSlides-1}if(b(J[p.currentSlide]).is("img")){p.currentImage=b(J[p.currentSlide])}else{p.currentImage=b(J[p.currentSlide]).find("img:first")}if(O.controlNav){g=K.find(".rambling-controlNav a");g.removeClass("active");g.filter(":eq("+p.currentSlide+")").addClass("active")}o(O);K.find(".rambling-slice").remove();K.find(".rambling-box").remove();if(O.effect==="random"){S=["sliceDownRight","sliceDownLeft","sliceUpRight","sliceUpLeft","sliceUpDown","sliceUpDownLeft","fold","fade","slideInRight","slideInLeft","boxRandom","boxRain","boxRainReverse","boxRainGrow","boxRainGrowReverse"];p.randAnim=S[Math.floor(Math.random()*(S.length+1))];if(!p.randAnim){p.randAnim="fade"}}if(O.effect.indexOf(",")!==-1){S=O.effect.split(",");p.randAnim=S[Math.floor(Math.random()*S.length)];if(!p.randAnim){p.randAnim="fade"}}p.running=true;R=p.randAnim||O.effect;if(R.contains("slice")||R.contains("fold")){w(K,O,p);Q=0;v=0;H=0;i=K.find(".rambling-slice");if(R.contains("Left")){i=i.reverse()}N=R.replace(/Right/,"").replace(/Left/,"");E={sliceDown:function(){var U;U=b(this);U.css({top:"0px"});if(v===O.slices-1){setTimeout(function(){return U.animate({height:"100%",opacity:"1.0"},O.animSpeed,"",function(){return K.trigger("rambling:animFinished")})},100+Q)}else{setTimeout((function(){return U.animate({height:"100%",opacity:"1.0"},O.animSpeed)}),100+Q)}Q+=50;return v++},sliceUp:function(){var U;U=b(this);U.css({bottom:"0px"});if(v===O.slices-1){setTimeout((function(){return U.animate({height:"100%",opacity:"1.0"},O.animSpeed,"",function(){return K.trigger("rambling:animFinished")})}),100+Q)}else{setTimeout((function(){return U.animate({height:"100%",opacity:"1.0"},O.animSpeed)}),100+Q)}Q+=50;return v++},sliceUpDown:function(){var U;U=b(this);if(v===0){U.css({top:"0px"});v++}else{U.css({bottom:"0px"});v=0}if(H===O.slices-1){setTimeout((function(){return U.animate({height:"100%",opacity:"1.0"},O.animSpeed,"",function(){return K.trigger("rambling:animFinished")})}),100+Q)}else{setTimeout((function(){return U.animate({height:"100%",opacity:"1.0"},O.animSpeed)}),100+Q)}Q+=50;return H++},fold:function(){var V,U;U=b(this);V=U.width();U.css({top:"0px",height:"100%",width:"0px"});if(v===O.slices-1){setTimeout((function(){return U.animate({width:V,opacity:"1.0"},O.animSpeed,"",function(){return K.trigger("rambling:animFinished")})}),100+Q)}else{setTimeout((function(){return U.animate({width:V,opacity:"1.0"},O.animSpeed)}),100+Q)}Q+=50;return v++}};return i.each(E[N])}else{if(R==="fade"||R==="slideInRight"||R==="slideInLeft"){w(K,O,p);G={fade:{style:{height:"100%",width:""+(K.width())+"px",position:"absolute",top:0,left:0},animate:{opacity:"1"}},slideInRight:{style:{height:"100%",width:"0px",opacity:"1"}},slideInLeft:{style:{height:"100%",width:"0px",opacity:"1",left:"",right:"0px"},callback:function(U){var V;V={left:"0px",right:""};return U.css(V)}}};L=G[R];C=L.animate||{width:""+(K.width())+"px"};F=K.find(".rambling-slice:first");F.css(G[R].style);return F.animate(C,O.animSpeed*2,"",function(){if(L.callback){L.callback(F)}return K.trigger("rambling:animFinished")})}else{if(R.contains("box")){t(K,O,p);M=O.boxCols*O.boxRows;v=0;Q=0;D=K.find(".rambling-box");if(R.contains("Reverse")){D=D.reverse()}E={random:{beforeAnimation:function(){return D=D.shuffle()},animate:function(U){return U.each(function(){var V;V=b(this);if(v===M-1){setTimeout((function(){return V.animate({opacity:"1"},O.animSpeed,"",function(){return K.trigger("rambling:animFinished")})}),100+Q)}else{setTimeout((function(){return V.animate({opacity:"1"},O.animSpeed)}),100+Q)}Q+=20;return v++})}},rain:{beforeAnimation:function(){return D=D.as2dArray(O.boxCols)},animate:function(V){var W,X,U;U=[];for(W=0,X=O.boxCols*2;0<=X?W<X:W>X;0<=X?W++:W--){U.push((function(ab){var Z,aa,Y,ac;Z=ab;Y=function(ah){var ag,ae,af,aj,ai,ad;if(Z>=0&&Z<O.boxCols){aj=ah;ae=Z;ai=Q;ag=b(V[aj][ae]);ad=ag.width();af=ag.height();if(R.contains("Grow")){ag.css({width:0,height:0})}if(v===M-1){setTimeout((function(){return ag.animate({opacity:"1",width:ad,height:af},O.animSpeed/1.3,"",function(){return K.trigger("rambling:animFinished")})}),100+ai)}else{setTimeout((function(){return ag.animate({opacity:"1",width:ad,height:af},O.animSpeed/1.3)}),100+ai)}v++}return Z--};for(aa=0,ac=O.boxRows;0<=ac?aa<ac:aa>ac;0<=ac?aa++:aa--){Y(aa)}return Q+=100})(W))}return U}}};P=R.replace(/box/,"").replace(/Grow/,"").replace(/Reverse/,"").decapitalize();T=E[P];T.beforeAnimation();return T.animate(D)}}}};u=function(i){if(this.console&&console&&console.log){return console.log(i)}};this.stop=function(){var i;i=b(e);if(!i.data("rambling:vars").stop){i.data("rambling:vars").stop=true;return u("Stop Slider")}};this.start=function(){var i;i=b(e);if(i.data("rambling:vars").stop){i.data("rambling:vars").stop=false;return u("Start Slider")}};y.afterLoad.call(this);return this};a=["stop","start"];b.fn.ramblingSlider=function(d){return this.each(function(f,h){var e,g;e=b(this);g=e.data("ramblingSlider");if(a.contains(d)&&g){g[d]()}if(g){return g}g=new c(this,d);return e.data("ramblingSlider",g)})};b.fn.ramblingSlider.defaults={effect:"random",slices:15,boxCols:8,boxRows:4,animSpeed:500,pauseTime:3000,startSlide:0,directionNav:true,directionNavHide:true,controlNav:true,controlNavThumbs:false,controlNavThumbsFromRel:false,controlNavThumbsSearch:".jpg",controlNavThumbsReplace:"_thumb.jpg",adaptImages:false,useLargerImage:true,alignBottom:false,keyboardNav:true,pauseOnHover:true,manualAdvance:false,captionOpacity:0.8,prevText:"Prev",nextText:"Next",beforeChange:function(){},afterChange:function(){},slideshowEnd:function(){},lastSlide:function(){},afterLoad:function(){}};b.fn.reverse=[].reverse;b.fn.shuffle=[].shuffle;return b.fn.as2dArray=function(d){var e,f,g;g=0;f=0;e=b("");e[g]=b("");this.each(function(){e[g][f]=b(this);f++;if(f===d){g++;f=0;return e[g]=b("")}});return e}})(jQuery);String.prototype.contains=function(a){return this.indexOf(a)!==-1};String.prototype.decapitalize=function(){var b,a;b=this.slice(0,1);a=this.slice(1);return""+(b.toLowerCase())+a}}).call(this);