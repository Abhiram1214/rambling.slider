(function(){Array.prototype.shuffle=function(){var c,b,d,a;d=this.length;for(c=d;d<=1?c<=1:c>=1;d<=1?c++:c--){this[c]=this[c];b=parseInt(Math.random()*c);a=this[--c];this[c]=this[b];this[b]=a}return this};Array.prototype.contains=function(c){var a,b;b=this.length;for(a=0;0<=b?a<b:a>b;0<=b?a++:a--){if(c===this[a]){return true}}return false};(function(a){var b;b=function(d,e){var j,z,f,s,v,g,l,p,u,q,w,n,y,c,h,x,r,m,t,o,A,k;x=a.extend({},a.fn.ramblingSlider.defaults,e);o={currentSlide:0,currentImage:"",totalSlides:0,randAnim:"",running:false,paused:false,stop:false};p={};g={setSliderBackground:function(i,B){return i.css({background:"url("+(B.currentImage.attr("src"))+") no-repeat"})},getRamblingSlice:function(F,i,D,E){var B,G,C;B="url("+(E.currentImage.attr("src"))+") no-repeat -"+((F+(i*F))-F)+"px 0%";C=F;if(i===(D-1)){B="url("+(E.currentImage.attr("src"))+") no-repeat -"+((F+(i*F))-F)+"px 0%";C=r.width()-(F*i)}G={left:(F*i)+"px",width:C+"px",height:"0px",opacity:"0",background:B,overflow:"hidden"};return a('<div class="rambling-slice"></div>').css(G)},getRamblingBox:function(E,G,I,C,D,F){var i,H,B;i="url("+(F.currentImage.attr("src"))+") no-repeat -"+((E+(C*E))-E)+"px -"+((G+(I*G))-G)+"px";B=E;if(C===(D.boxCols-1)){i="url("+(F.currentImage.attr("src"))+") no-repeat -"+((E+(C*E))-E)+"px -"+((G+(I*G))-G)+"px";B=r.width()-(E*C)}H={opacity:0,left:(E*C)+"px",top:(G*I)+"px",width:B+"px",height:G+"px",background:i,overflow:"hidden"};return a('<div class="rambling-box"></div>').css(H)}};j={setSliderBackground:function(){var C,i,B;B=o.currentImage;i=r.find(".currentImage");if(!i.length){C="alignTop";if(x.alignBottom){C="alignBottom"}i=a('<img src="" alt="currentImage" class="currentImage"/>');i.addClass(C);i.css({display:"block"});r.find("#rambling-animation").prepend(i)}return i.attr({src:B.attr("src"),alt:B.attr("alt")})},getRamblingSlice:function(H,i,E,G){var C,D,B,F;D=g.getRamblingSlice(H,i,E,G);D.css({background:"none"});D.append('<span><img src="'+(G.currentImage.attr("src"))+'" alt=""/></span>');C=0;F="auto";if(x.alignBottom){C="auto";F=0}B={display:"block",width:r.width(),left:"-"+((H+(i*H))-H)+"px",bottom:C,top:F};D.find("img").css(B);return D},getRamblingBox:function(F,H,J,C,D,G){var i,E,B,I;E=g.getRamblingBox(F,H,J,C,D,G);i=false;I=""+((H+(J*H))-H)+"px";if(D.alignBottom){i=""+(H*(D.boxRows-(J+1)))+"px";I=false}B={display:"block",width:r.width(),left:"-"+((F+(C*F))-F)+"px",top:"auto",bottom:"auto"};if(I){B.top="-"+I}if(i){B.bottom="-"+i}E.css({background:"none",top:I||"auto",bottom:i||"auto"});E.append('<span><img src="'+G.currentImage.attr("src")+'" alt=""/></span>');E.find("img").css(B);return E}};a.extend(p,g);if(x.adaptImages){a.extend(p,j)}r=a(d);r.data("rambling:vars",o);r.css({position:"relative"});r.addClass("ramblingSlider");if(x.adaptImages){y=a('<div id="rambling-animation"></div>');y.css({width:r.width(),height:r.height(),overflow:"hidden"});r.prepend(y);r.addClass("adaptingSlider")}q=r.children(":not(#rambling-animation)");q.each(function(){var D,i,B,C;D=a(this);C="";if(!D.is("img")){if(D.is("a")){D.addClass("rambling-imageLink");C=D}D=D.find("img:first")}B=D.width();if(B===0){B=D.attr("width")}i=D.height();if(i===0){i=D.attr("height")}if(B>r.width()&&x.useLargerImage){r.width(B)}if(i>r.height()&&(x.useLargerImage||!x.adaptImages)){r.height(i)}if(C!==""){C.css({display:"none"})}D.css({display:"none"});return o.totalSlides++});if(x.startSlide>0){if(x.startSlide>=o.totalSlides){x.startSlide=o.totalSlides-1}o.currentSlide=x.startSlide}if(a(q[o.currentSlide]).is("img")){o.currentImage=a(q[o.currentSlide])}else{o.currentImage=a(q[o.currentSlide]).find("img:first")}if(a(q[o.currentSlide]).is("a")){a(q[o.currentSlide]).css("display","block")}p.setSliderBackground(r,o);r.append(a('<div class="rambling-caption"><p></p></div>').css({display:"none",opacity:x.captionOpacity}));n=function(B){var i,C;i=r.find(".rambling-caption");C=o.currentImage.attr("title");if((C!=null)&&C!==""){if(C.substr(0,1)==="#"){C=a(C).html()}if(i.css("display")==="block"){i.find("p").fadeOut(B.animSpeed,function(){a(this).html(C);return a(this).fadeIn(B.animSpeed)})}else{i.find("p").html(C)}return i.fadeIn(B.animSpeed)}else{return i.fadeOut(B.animSpeed)}};n(x);m=0;if(!x.manualAdvance&&q.length>1){m=setInterval((function(){return h(r,q,x,false)}),x.pauseTime)}z=function(){clearInterval(m);return m=""};if(x.directionNav){r.append('<div class="rambling-directionNav"><a class="rambling-prevNav">'+x.prevText+'</a><a class="rambling-nextNav">'+x.nextText+"</a></div>");if(x.directionNavHide){l=r.find(".rambling-directionNav");l.hide();r.hover((function(){return l.show()}),(function(){return l.hide()}))}w=function(C,i,B,D){if(o.running){return false}z();o.currentSlide-=2;return h(C,i,B,D)};r.find("a.rambling-prevNav").live("click",function(){return w("prev")});r.find("a.rambling-nextNav").live("click",function(){return w("next")})}if(x.controlNav){c=a('<div class="rambling-controlNav"></div>');r.append(c);A=function(B){var C;if(x.controlNavThumbs){C=q.eq(B);if(!C.is("img")){C=C.find("img:first")}if(x.controlNavThumbsFromRel){return c.append('<a class="rambling-control" rel="'+B+'"><img src="'+C.attr("rel")+'" alt="" /></a>')}else{return c.append('<a class="rambling-control" rel="'+B+'"><img src="'+C.attr("src").replace(x.controlNavThumbsSearch,x.controlNavThumbsReplace)+'" alt="" /></a>')}}else{return c.append('<a class="rambling-control" rel="'+B+'">'+(B+1)+"</a>")}};for(u=0,k=q.length;0<=k?u<k:u>k;0<=k?u++:u--){A(u)}f=r.find(".rambling-controlNav a");f.filter(":eq("+o.currentSlide+")").addClass("active");f.live("click",function(){if(o.running){return false}if(a(this).hasClass("active")){return false}z();p.setSliderBackground(r,o);o.currentSlide=a(this).attr("rel")-1;return h(r,q,x,"control")})}if(x.keyboardNav){a(window).keypress(function(i){if(i.keyCode==="37"){if(o.running){return false}z();o.currentSlide-=2;h(r,q,x,"prev")}if(i.keyCode==="39"){if(o.running){return false}z();return h(r,q,x,"next")}})}if(x.pauseOnHover){r.hover(function(){o.paused=true;return z()},function(){o.paused=false;if(m===""&&!x.manualAdvance){return m=setInterval((function(){return h(r,q,x,false)}),x.pauseTime)}})}r.bind("rambling:animFinished",function(){o.running=false;a(q).each(function(){if(a(this).is("a")){return a(this).css({display:"none"})}});if(a(q[o.currentSlide]).is("a")){a(q[o.currentSlide]).css({display:"block"})}if(m===""&&!o.paused&&!x.manualAdvance){m=setInterval((function(){return h(r,q,x,false)}),x.pauseTime)}p.setSliderBackground(r,o);return x.afterChange.call(this)});v=function(E,D,F){var C,G,B;B=[];for(C=0,G=D.slices;0<=G?C<G:C>G;0<=G?C++:C--){B.push((function(I){var H,J;J=Math.round(E.width()/D.slices);H=E;if(D.adaptImages){H=E.find("#rambling-animation")}return H.append(p.getRamblingSlice(J,I,D.slices,F))})(C))}return B};s=function(D,B,F){var G,C,E,H,i;C=Math.round(D.width()/B.boxCols);G=Math.round(D.height()/B.boxRows);i=[];for(E=0,H=B.boxRows;0<=H?E<H:E>H;0<=H?E++:E--){i.push((function(J){var K,L,I;I=[];for(K=0,L=B.boxCols;0<=L?K<L:K>L;0<=L?K++:K--){I.push((function(N){var M;M=D;if(B.adaptImages){M=D.find("#rambling-animation")}return M.append(p.getRamblingBox(C,G,J,N,B,F))})(K))}return I})(E))}return i};h=function(J,I,N,H){var B,M,D,F,R,C,S,O,Q,K,E,i,P,L,G;o=J.data("rambling:vars");if(o&&o.currentSlide===o.totalSlides-1){N.lastSlide.call(this)}if((!o||o.stop)&&!H){return false}N.beforeChange.call(this);o.currentSlide++;if(o.currentSlide===o.totalSlides){o.currentSlide=0;N.slideshowEnd.call(this)}if(o.currentSlide<0){o.currentSlide=o.totalSlides-1}if(a(I[o.currentSlide]).is("img")){o.currentImage=a(I[o.currentSlide])}else{o.currentImage=a(I[o.currentSlide]).find("img:first")}if(N.controlNav){f=J.find(".rambling-controlNav a");f.removeClass("active");f.filter(":eq("+o.currentSlide+")").addClass("active")}n(N);J.find(".rambling-slice").remove();J.find(".rambling-box").remove();if(N.effect==="random"){R=["sliceDownRight","sliceDownLeft","sliceUpRight","sliceUpLeft","sliceUpDown","sliceUpDownLeft","fold","fade","slideInRight","slideInLeft","boxRandom","boxRain","boxRainReverse","boxRainGrow","boxRainGrowReverse"];o.randAnim=R[Math.floor(Math.random()*(R.length+1))];if(!o.randAnim){o.randAnim="fade"}}if(N.effect.indexOf(",")!==-1){R=N.effect.split(",");o.randAnim=R[Math.floor(Math.random()*R.length)];if(!o.randAnim){o.randAnim="fade"}}o.running=true;Q=o.randAnim||N.effect;if(Q.contains("slice")||Q.contains("fold")){v(J,N,o);P=0;u=0;G=0;i=J.find(".rambling-slice");if(Q.contains("Left")){i=i.reverse()}M=Q.replace(/Right/,"").replace(/Left/,"");D={sliceDown:function(){var T;T=a(this);T.css({top:"0px"});if(u===N.slices-1){setTimeout(function(){return T.animate({height:"100%",opacity:"1.0"},N.animSpeed,"",function(){return J.trigger("rambling:animFinished")})},100+P)}else{setTimeout((function(){return T.animate({height:"100%",opacity:"1.0"},N.animSpeed)}),100+P)}P+=50;return u++},sliceUp:function(){var T;T=a(this);T.css({bottom:"0px"});if(u===N.slices-1){setTimeout((function(){return T.animate({height:"100%",opacity:"1.0"},N.animSpeed,"",function(){return J.trigger("rambling:animFinished")})}),100+P)}else{setTimeout((function(){return T.animate({height:"100%",opacity:"1.0"},N.animSpeed)}),100+P)}P+=50;return u++},sliceUpDown:function(){var T;T=a(this);if(u===0){T.css({top:"0px"});u++}else{T.css({bottom:"0px"});u=0}if(G===N.slices-1){setTimeout((function(){return T.animate({height:"100%",opacity:"1.0"},N.animSpeed,"",function(){return J.trigger("rambling:animFinished")})}),100+P)}else{setTimeout((function(){return T.animate({height:"100%",opacity:"1.0"},N.animSpeed)}),100+P)}P+=50;return G++},fold:function(){var U,T;T=a(this);U=T.width();T.css({top:"0px",height:"100%",width:"0px"});if(u===N.slices-1){setTimeout((function(){return T.animate({width:U,opacity:"1.0"},N.animSpeed,"",function(){return J.trigger("rambling:animFinished")})}),100+P)}else{setTimeout((function(){return T.animate({width:U,opacity:"1.0"},N.animSpeed)}),100+P)}P+=50;return u++}};return i.each(D[M])}else{if(Q==="fade"||Q==="slideInRight"||Q==="slideInLeft"){v(J,N,o);F={fade:{style:{height:"100%",width:""+(J.width())+"px",position:"absolute",top:0,left:0},animate:{opacity:"1"}},slideInRight:{style:{height:"100%",width:"0px",opacity:"1"}},slideInLeft:{style:{height:"100%",width:"0px",opacity:"1",left:"",right:"0px"},callback:function(T){var U;U={left:"0px",right:""};return T.css(U)}}};K=F[Q];B=K.animate||{width:""+(J.width())+"px"};E=J.find(".rambling-slice:first");E.css(F[Q].style);return E.animate(B,N.animSpeed*2,"",function(){if(K.callback){K.callback(E)}return J.trigger("rambling:animFinished")})}else{if(Q.contains("box")){s(J,N,o);L=N.boxCols*N.boxRows;u=0;P=0;C=J.find(".rambling-box");if(Q.contains("Reverse")){C=C.reverse()}D={random:{beforeAnimation:function(){return C=C.shuffle()},animate:function(T){return T.each(function(){var U;U=a(this);if(u===L-1){setTimeout((function(){return U.animate({opacity:"1"},N.animSpeed,"",function(){return J.trigger("rambling:animFinished")})}),100+P)}else{setTimeout((function(){return U.animate({opacity:"1"},N.animSpeed)}),100+P)}P+=20;return u++})}},rain:{beforeAnimation:function(){return C=C.as2dArray(N.boxCols)},animate:function(U){var V,W,T;T=[];for(V=0,W=N.boxCols*2;0<=W?V<W:V>W;0<=W?V++:V--){T.push((function(aa){var Y,Z,X,ab;Y=aa;X=function(ag){var af,ad,ae,ai,ah,ac;if(Y>=0&&Y<N.boxCols){ai=ag;ad=Y;ah=P;af=a(U[ai][ad]);ac=af.width();ae=af.height();if(Q.contains("Grow")){af.css({width:0,height:0})}if(u===L-1){setTimeout((function(){return af.animate({opacity:"1",width:ac,height:ae},N.animSpeed/1.3,"",function(){return J.trigger("rambling:animFinished")})}),100+ah)}else{setTimeout((function(){return af.animate({opacity:"1",width:ac,height:ae},N.animSpeed/1.3)}),100+ah)}u++}return Y--};for(Z=0,ab=N.boxRows;0<=ab?Z<ab:Z>ab;0<=ab?Z++:Z--){X(Z)}return P+=100})(V))}return T}}};O=Q.replace(/box/,"").replace(/Grow/,"").replace(/Reverse/,"").decapitalize();S=D[O];S.beforeAnimation();return S.animate(C)}}}};t=function(i){if(this.console&&console&&console.log){return console.log(i)}};this.stop=function(){var i;i=a(d);if(!i.data("rambling:vars").stop){i.data("rambling:vars").stop=true;return t("Stop Slider")}};this.start=function(){var i;i=a(d);if(i.data("rambling:vars").stop){i.data("rambling:vars").stop=false;return t("Start Slider")}};x.afterLoad.call(this);return this};a.fn.ramblingSlider=function(c){return this.each(function(e,g){var d,f;d=a(this);if(d.data("ramblingslider")){return d.data("ramblingslider")}f=new b(this,c);return d.data("ramblingslider",f)})};a.fn.ramblingSlider.defaults={effect:"random",slices:15,boxCols:8,boxRows:4,animSpeed:500,pauseTime:3000,startSlide:0,directionNav:true,directionNavHide:true,controlNav:true,controlNavThumbs:false,controlNavThumbsFromRel:false,controlNavThumbsSearch:".jpg",controlNavThumbsReplace:"_thumb.jpg",adaptImages:false,useLargerImage:true,alignBottom:false,keyboardNav:true,pauseOnHover:true,manualAdvance:false,captionOpacity:0.8,prevText:"Prev",nextText:"Next",beforeChange:function(){},afterChange:function(){},slideshowEnd:function(){},lastSlide:function(){},afterLoad:function(){}};a.fn.reverse=[].reverse;a.fn.shuffle=[].shuffle;return a.fn.as2dArray=function(c){var d,e,f;f=0;e=0;d=a("");d[f]=a("");this.each(function(){d[f][e]=a(this);e++;if(e===c){f++;e=0;return d[f]=a("")}});return d}})(jQuery);String.prototype.contains=function(a){return this.indexOf(a)!==-1};String.prototype.decapitalize=function(){var b,a;b=this.slice(0,1);a=this.slice(1);return""+(b.toLowerCase())+a}}).call(this);