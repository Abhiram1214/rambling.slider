(function(){(function(a){var b;b=function(d,e){var j,z,f,s,v,g,l,p,u,q,w,n,y,c,h,x,r,m,t,o,A,k;x=a.extend({},a.fn.ramblingSlider.defaults,e);o={currentSlide:0,currentImage:"",totalSlides:0,randAnim:"",running:false,paused:false,stop:false};p={};g={setSliderBackground:function(i,B){return i.css({background:"url("+(B.currentImage.attr("src"))+") no-repeat"})},getRamblingSlice:function(F,i,D,E){var B,G,C;B="url("+(E.currentImage.attr("src"))+") no-repeat -"+((F+(i*F))-F)+"px 0%";C=F;if(i===(D-1)){B="url("+(E.currentImage.attr("src"))+") no-repeat -"+((F+(i*F))-F)+"px 0%";C=r.width()-(F*i)}G={left:(F*i)+"px",width:C+"px",height:"0px",opacity:"0",background:B,overflow:"hidden"};return a('<div class="rambling-slice"></div>').css(G)},getRamblingBox:function(E,G,I,C,D,F){var i,H,B;i="url("+(F.currentImage.attr("src"))+") no-repeat -"+((E+(C*E))-E)+"px -"+((G+(I*G))-G)+"px";B=E;if(C===(D.boxCols-1)){i="url("+(F.currentImage.attr("src"))+") no-repeat -"+((E+(C*E))-E)+"px -"+((G+(I*G))-G)+"px";B=r.width()-(E*C)}H={opacity:0,left:(E*C)+"px",top:(G*I)+"px",width:B+"px",height:G+"px",background:i,overflow:"hidden"};return a('<div class="rambling-box"></div>').css(H)}};j={setSliderBackground:function(){var C,i,B;B=o.currentImage;i=r.find(".currentImage");if(!i.length){C="alignTop";if(x.alignBottom){C="alignBottom"}i=a('<img src="" alt="currentImage" class="currentImage"/>');i.addClass(C);i.css({display:"block"});r.find("#rambling-animation").prepend(i)}return i.attr({src:B.attr("src"),alt:B.attr("alt")})},getRamblingSlice:function(H,i,E,G){var C,D,B,F;D=g.getRamblingSlice(H,i,E,G);D.css({background:"none"});D.append('<span><img src="'+(G.currentImage.attr("src"))+'" alt=""/></span>');C=0;F="auto";if(x.alignBottom){C="auto";F=0}B={display:"block",width:r.width(),left:"-"+((H+(i*H))-H)+"px",bottom:C,top:F};D.find("img").css(B);return D},getRamblingBox:function(F,H,J,C,D,G){var i,E,B,I;E=g.getRamblingBox(F,H,J,C,D,G);i=false;I=""+((H+(J*H))-H)+"px";if(D.alignBottom){i=""+(H*(D.boxRows-(J+1)))+"px";I=false}B={display:"block",width:r.width(),left:"-"+((F+(C*F))-F)+"px",top:"auto",bottom:"auto"};if(I){B.top="-"+I}if(i){B.bottom="-"+i}E.css({background:"none",top:I||"auto",bottom:i||"auto"});E.append('<span><img src="'+G.currentImage.attr("src")+'" alt=""/></span>');E.find("img").css(B);return E}};a.extend(p,g);if(x.adaptImages){a.extend(p,j)}r=a(d);r.data("rambling:vars",o);r.css({position:"relative"});r.addClass("ramblingSlider");if(x.adaptImages){y=a('<div id="rambling-animation"></div>');y.css({width:r.width(),height:r.height(),overflow:"hidden"});r.prepend(y);r.addClass("adaptingSlider")}q=r.children(":not(#rambling-animation)");q.each(function(){var D,i,B,C;D=a(this);C="";if(!D.is("img")){if(D.is("a")){D.addClass("rambling-imageLink");C=D}D=D.find("img:first")}B=D.width();if(B===0){B=D.attr("width")}i=D.height();if(i===0){i=D.attr("height")}if(B>r.width()&&x.useLargerImage){r.width(B)}if(i>r.height()&&(x.useLargerImage||!x.adaptImages)){r.height(i)}if(C!==""){C.css({display:"none"})}D.css({display:"none"});return o.totalSlides++});if(x.startSlide>0){if(x.startSlide>=o.totalSlides){x.startSlide=o.totalSlides-1}o.currentSlide=x.startSlide}if(a(q[o.currentSlide]).is("img")){o.currentImage=a(q[o.currentSlide])}else{o.currentImage=a(q[o.currentSlide]).find("img:first")}if(a(q[o.currentSlide]).is("a")){a(q[o.currentSlide]).css("display","block")}p.setSliderBackground(r,o);r.append(a('<div class="rambling-caption"><p></p></div>').css({display:"none",opacity:x.captionOpacity}));n=function(B){var i,C;i=r.find(".rambling-caption");C=o.currentImage.attr("title");if((C!=null)&&C!==""){if(C.substr(0,1)==="#"){C=a(C).html()}if(i.css("display")==="block"){i.find("p").fadeOut(B.animSpeed,function(){a(this).html(C);return a(this).fadeIn(B.animSpeed)})}else{i.find("p").html(C)}return i.fadeIn(B.animSpeed)}else{return i.fadeOut(B.animSpeed)}};n(x);m=0;if(!x.manualAdvance&&q.length>1){m=setInterval((function(){return h(r,q,x,false)}),x.pauseTime)}z=function(){clearInterval(m);return m=""};if(x.directionNav){r.append('<div class="rambling-directionNav"><a class="rambling-prevNav">'+x.prevText+'</a><a class="rambling-nextNav">'+x.nextText+"</a></div>");if(x.directionNavHide){l=r.find(".rambling-directionNav");l.hide();r.hover((function(){return l.show()}),(function(){return l.hide()}))}w=function(C,i,B,D){if(o.running){return false}z();o.currentSlide-=2;return h(C,i,B,D)};r.find("a.rambling-prevNav").live("click",function(){return w("prev")});r.find("a.rambling-nextNav").live("click",function(){return w("next")})}if(x.controlNav){c=a('<div class="rambling-controlNav"></div>');r.append(c);A=function(B){var C;if(x.controlNavThumbs){C=q.eq(B);if(!C.is("img")){C=C.find("img:first")}if(x.controlNavThumbsFromRel){return c.append('<a class="rambling-control" rel="'+B+'"><img src="'+C.attr("rel")+'" alt="" /></a>')}else{return c.append('<a class="rambling-control" rel="'+B+'"><img src="'+C.attr("src").replace(x.controlNavThumbsSearch,x.controlNavThumbsReplace)+'" alt="" /></a>')}}else{return c.append('<a class="rambling-control" rel="'+B+'">'+(B+1)+"</a>")}};for(u=0,k=q.length;0<=k?u<k:u>k;0<=k?u++:u--){A(u)}f=r.find(".rambling-controlNav a");f.filter(":eq("+o.currentSlide+")").addClass("active");f.live("click",function(){if(o.running){return false}if(a(this).hasClass("active")){return false}z();p.setSliderBackground(r,o);o.currentSlide=a(this).attr("rel")-1;return h(r,q,x,"control")})}if(x.keyboardNav){a(window).keypress(function(i){if(i.keyCode==="37"){if(o.running){return false}z();o.currentSlide-=2;h(r,q,x,"prev")}if(i.keyCode==="39"){if(o.running){return false}z();return h(r,q,x,"next")}})}if(x.pauseOnHover){r.hover(function(){o.paused=true;return z()},function(){o.paused=false;if(m===""&&!x.manualAdvance){return m=setInterval((function(){return h(r,q,x,false)}),x.pauseTime)}})}r.bind("rambling:animFinished",function(){o.running=false;a(q).each(function(){if(a(this).is("a")){return a(this).css({display:"none"})}});if(a(q[o.currentSlide]).is("a")){a(q[o.currentSlide]).css({display:"block"})}if(m===""&&!o.paused&&!x.manualAdvance){m=setInterval((function(){return h(r,q,x,false)}),x.pauseTime)}p.setSliderBackground(r,o);return x.afterChange.call(this)});v=function(E,D,F){var C,G,B;B=[];for(C=0,G=D.slices;0<=G?C<G:C>G;0<=G?C++:C--){B.push((function(I){var H,J;J=Math.round(E.width()/D.slices);H=E;if(D.adaptImages){H=E.find("#rambling-animation")}return H.append(p.getRamblingSlice(J,I,D.slices,F))})(C))}return B};s=function(D,B,F){var G,C,E,H,i;C=Math.round(D.width()/B.boxCols);G=Math.round(D.height()/B.boxRows);i=[];for(E=0,H=B.boxRows;0<=H?E<H:E>H;0<=H?E++:E--){i.push((function(J){var K,L,I;I=[];for(K=0,L=B.boxCols;0<=L?K<L:K>L;0<=L?K++:K--){I.push((function(N){var M;M=D;if(B.adaptImages){M=D.find("#rambling-animation")}return M.append(p.getRamblingBox(C,G,J,N,B,F))})(K))}return I})(E))}return i};h=function(O,N,R,L){var Q,E,U,K,D,M,I,T,H,G,F,B,S,P,J,C,i;o=O.data("rambling:vars");if(o&&o.currentSlide===o.totalSlides-1){R.lastSlide.call(this)}if((!o||o.stop)&&!L){return false}R.beforeChange.call(this);o.currentSlide++;if(o.currentSlide===o.totalSlides){o.currentSlide=0;R.slideshowEnd.call(this)}if(o.currentSlide<0){o.currentSlide=o.totalSlides-1}if(a(N[o.currentSlide]).is("img")){o.currentImage=a(N[o.currentSlide])}else{o.currentImage=a(N[o.currentSlide]).find("img:first")}if(R.controlNav){f=O.find(".rambling-controlNav a");f.removeClass("active");f.filter(":eq("+o.currentSlide+")").addClass("active")}n(R);O.find(".rambling-slice").remove();O.find(".rambling-box").remove();if(R.effect==="random"){U=["sliceDownRight","sliceDownLeft","sliceUpRight","sliceUpLeft","sliceUpDown","sliceUpDownLeft","fold","fade","boxRandom","boxRain","boxRainReverse","boxRainGrow","boxRainGrowReverse"];o.randAnim=U[Math.floor(Math.random()*(U.length+1))];if(!o.randAnim){o.randAnim="fade"}}if(R.effect.indexOf(",")!==-1){U=R.effect.split(",");o.randAnim=U[Math.floor(Math.random()*U.length)];if(!o.randAnim){o.randAnim="fade"}}o.running=true;T=o.randAnim||R.effect;if(T.contains("slice")||T.contains("fold")){v(O,R,o);S=0;u=0;J=0;B=O.find(".rambling-slice");if(T.contains("Left")){B=B.reverse()}Q=T.replace(/Right/,"").replace(/Left/,"");E={sliceDown:function(){var V;V=a(this);V.css({top:"0px"});if(u===R.slices-1){setTimeout(function(){return V.animate({height:"100%",opacity:"1.0"},R.animSpeed,"",function(){return O.trigger("rambling:animFinished")})},100+S)}else{setTimeout((function(){return V.animate({height:"100%",opacity:"1.0"},R.animSpeed)}),100+S)}S+=50;return u++},sliceUp:function(){var V;V=a(this);V.css({bottom:"0px"});if(u===R.slices-1){setTimeout((function(){return V.animate({height:"100%",opacity:"1.0"},R.animSpeed,"",function(){return O.trigger("rambling:animFinished")})}),100+S)}else{setTimeout((function(){return V.animate({height:"100%",opacity:"1.0"},R.animSpeed)}),100+S)}S+=50;return u++},sliceUpDown:function(){var V;V=a(this);if(u===0){V.css({top:"0px"});u++}else{V.css({bottom:"0px"});u=0}if(J===R.slices-1){setTimeout((function(){return V.animate({height:"100%",opacity:"1.0"},R.animSpeed,"",function(){return O.trigger("rambling:animFinished")})}),100+S)}else{setTimeout((function(){return V.animate({height:"100%",opacity:"1.0"},R.animSpeed)}),100+S)}S+=50;return J++},fold:function(){var W,V;V=a(this);W=V.width();V.css({top:"0px",height:"100%",width:"0px"});if(u===R.slices-1){setTimeout((function(){return V.animate({width:W,opacity:"1.0"},R.animSpeed,"",function(){return O.trigger("rambling:animFinished")})}),100+S)}else{setTimeout((function(){return V.animate({width:W,opacity:"1.0"},R.animSpeed)}),100+S)}S+=50;return u++}};return B.each(E[Q])}else{if(T==="fade"){v(O,R,o);H=O.find(".rambling-slice:first");F={height:"100%",width:O.width()+"px",position:"absolute",top:0,left:0};H.css(F);return H.animate({opacity:"1.0"},R.animSpeed*2,"",function(){return O.trigger("rambling:animFinished")})}else{if(T==="slideInRight"){v(O,R,o);H=O.find(".rambling-slice:first");F={height:"100%",width:"0px",opacity:"1"};H.css(F);return H.animate({width:O.width()+"px"},R.animSpeed*2,"",function(){return O.trigger("rambling:animFinished")})}else{if(T==="slideInLeft"){v(O,R,o);H=O.find(".rambling-slice:first");F={height:"100%",width:"0px",opacity:"1",left:"",right:"0px"};H.css(F);return H.animate({width:O.width()+"px"},R.animSpeed*2,"",function(){var V;V={left:"0px",right:""};H.css(V);return O.trigger("rambling:animFinished")})}else{if(T==="boxRandom"){s(O,R,o);P=R.boxCols*R.boxRows;u=0;S=0;D=O.find(".rambling-box").shuffle();return D.each(function(){var V;V=a(this);if(u===P-1){setTimeout((function(){return V.animate({opacity:"1"},R.animSpeed,"",function(){return O.trigger("rambling:animFinished")})}),100+S)}else{setTimeout((function(){return V.animate({opacity:"1"},R.animSpeed)}),100+S)}S+=20;return u++})}else{if(["boxRain","boxRainReverse","boxRainGrow","boxRainGrowReverse"].contains(T)){s(O,R,o);P=R.boxCols*R.boxRows;u=0;S=0;G=0;M=0;K=new Array();K[G]=new Array();D=O.find(".rambling-box");if(T==="boxRainReverse"||T==="boxRainGrowReverse"){D=D.reverse()}D.each(function(){K[G][M]=a(this);M++;if(M===R.boxCols){G++;M=0;return K[G]=new Array()}});i=[];for(I=0,C=R.boxCols*2;0<=C?I<C:I>C;0<=C?I++:I--){i.push((function(Y){var W,X,V,Z;W=Y;V=function(aa){if(W>=0&&W<R.boxCols){(function(ah,ac,ag,ad,ai){var af,ae,ab;af=a(K[ah][ac]);ab=af.width();ae=af.height();if(T==="boxRainGrow"||T==="boxRainGrowReverse"){af.width(0).height(0)}if(ad===ai-1){return setTimeout((function(){return af.animate({opacity:"1",width:ab,height:ae},R.animSpeed/1.3,"",function(){return O.trigger("rambling:animFinished")})}),100+ag)}else{return setTimeout((function(){return af.animate({opacity:"1",width:ab,height:ae},R.animSpeed/1.3)}),100+ag)}})(aa,W,S,u,P);u++}return W--};for(X=0,Z=R.boxRows;0<=Z?X<Z:X>Z;0<=Z?X++:X--){V(X)}return S+=100})(I))}return i}}}}}}};t=function(i){if(this.console&&console&&console.log){return console.log(i)}};this.stop=function(){var i;i=a(d);if(!i.data("rambling:vars").stop){i.data("rambling:vars").stop=true;return t("Stop Slider")}};this.start=function(){var i;i=a(d);if(i.data("rambling:vars").stop){i.data("rambling:vars").stop=false;return t("Start Slider")}};x.afterLoad.call(this);return this};a.fn.ramblingSlider=function(c){return this.each(function(e,g){var d,f;d=a(this);if(d.data("ramblingslider")){return d.data("ramblingslider")}f=new b(this,c);return d.data("ramblingslider",f)})};a.fn.ramblingSlider.defaults={effect:"random",slices:15,boxCols:8,boxRows:4,animSpeed:500,pauseTime:3000,startSlide:0,directionNav:true,directionNavHide:true,controlNav:true,controlNavThumbs:false,controlNavThumbsFromRel:false,controlNavThumbsSearch:".jpg",controlNavThumbsReplace:"_thumb.jpg",adaptImages:false,useLargerImage:true,alignBottom:false,keyboardNav:true,pauseOnHover:true,manualAdvance:false,captionOpacity:0.8,prevText:"Prev",nextText:"Next",beforeChange:function(){},afterChange:function(){},slideshowEnd:function(){},lastSlide:function(){},afterLoad:function(){}};a.fn.reverse=[].reverse;return a.fn.shuffle=[].shuffle})(jQuery);String.prototype.contains=function(a){return this.indexOf(a)!==-1};String.prototype.decapitalize=function(){var b,a;b=this.slice(0,1);a=this.slice(1);return""+(b.toLowerCase())+a}}).call(this);